<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Form Grid</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
        }
        .form-square {
            border: 1px solid #ccc;
            padding: 20px;
            margin-right: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .form-square form {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .form-square input, .form-square select {
            margin-bottom: 10px;
            width: 100%;
        }
        .form-square button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Dynamic Form Grid</h1>
    <div class="container" id="formContainer">
        <div class="form-square">
            <form>
                <label for="type">Type:</label>
                <select id="type" name="type" required onchange="updateForm(this)">
                    <option value="Position">Position</option>
                    <option value="Operation">Operation</option>
                </select>
                <div id="additionalFields">
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required>
                </div>
            </form>
            <button type="button" onclick="addForm()">+</button>
        </div>
    </div>
    <button type="button" onclick="submitForms()">Submit</button>
    <h2>Result</h2>
    <pre id="result"></pre>

    <script>
        function updateForm(selectElement) {
            const additionalFields = selectElement.parentElement.querySelector('#additionalFields');
            additionalFields.innerHTML = ''; // Clear existing fields

            if (selectElement.value === 'Position') {
                additionalFields.innerHTML = `
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="name" required>
                `;
            } else if (selectElement.value === 'Operation') {
                additionalFields.innerHTML = `
                    <label for="operationType">Operation Type:</label>
                    <select id="operationType" name="operationType" required>
                        <option value="PLUS">PLUS</option>
                        <option value="MINUS">MINUS</option>
                    </select>
                `;
            }
        }

        function addForm() {
            const formContainer = document.getElementById('formContainer');

            const newFormSquare = document.createElement('div');
            newFormSquare.className = 'form-square';
            newFormSquare.innerHTML = `
                <form>
                    <label for="type">Type:</label>
                    <select id="type" name="type" required onchange="updateForm(this)">
                        <option value="Position">Position</option>
                        <option value="Operation">Operation</option>
                    </select>
                    <div id="additionalFields">
                        <label for="name">Name:</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                </form>
                <button type="button" onclick="addForm()">+</button>
            `;

            // Remove the last plus button before adding the new form
            const lastPlusButton = formContainer.querySelector('.form-square:last-child button');
            lastPlusButton.remove();

            formContainer.appendChild(newFormSquare);
        }

        function submitForms() {
            const formContainer = document.getElementById('formContainer');
            const formSquares = formContainer.querySelectorAll('.form-square');
            const resultArray = [];

            formSquares.forEach(square => {
                const form = square.querySelector('form');
                const type = form.querySelector('select[name="type"]').value;
                let formData = { type };

                if (type === 'Position') {
                    const name = form.querySelector('input[name="name"]').value;
                    formData.name = name;
                } else if (type === 'Operation') {
                    const operationType = form.querySelector('select[name="operationType"]').value;
                    formData.operationType = operationType;
                }

                resultArray.push(formData);
            });

            document.getElementById('result').innerText = JSON.stringify(resultArray, null, 2);
        }
    </script>
</body>
</html>
